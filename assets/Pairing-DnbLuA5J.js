import{c as de,r as o,p as W,E as Rt,j as t,l as F,t as j,F as Pe,G as jt,H as _t,o as Dt,I as Me,J as Ot,K as Y,M as ke,O as At,Q as Lt,S as Mt,T as kt,U as Bt,V as Ft,W as Ie,X as Vt,Y as Ht,Z as Wt,$ as Ut,q as je,a0 as zt,m as q,C as Kt,a as $t,B as Se,f as oe,g as qt}from"./index-DNAhENDT.js";import{B as Gt,F as _e}from"./Backdrop-BVlBnENP.js";import{F as Yt}from"./FieldContainerInput-DXREqmfX.js";import{c as De}from"./index-BdQq_4o_.js";import{u as Xt}from"./index-DMLd8nL5.js";import{C as Be}from"./chevron-down-DW3km1dx.js";import{C as Oe}from"./circle-help-Dmy7jVVt.js";import"./react-C7sMpjI8.js";import"./react-dom-ThsgQk-A.js";import"./alert-dialog-Cva_lt_P.js";import"./input-DbxTFjb-.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=de("Bluetooth",[["path",{d:"m7 7 10 10-5 5V2l5 5L7 17",key:"1q5490"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=de("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=de("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=de("ScanSearch",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["path",{d:"m16 16-1.9-1.9",key:"1dq9hf"}]]);var eo="DismissableLayer",ye="dismissableLayer.update",to="dismissableLayer.pointerDownOutside",oo="dismissableLayer.focusOutside",Ae,Ve=o.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),He=o.forwardRef((n,r)=>{const{disableOutsidePointerEvents:e=!1,onEscapeKeyDown:a,onPointerDownOutside:s,onFocusOutside:d,onInteractOutside:i,onDismiss:c,...l}=n,u=o.useContext(Ve),[h,y]=o.useState(null),E=(h==null?void 0:h.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,x]=o.useState({}),C=W(r,p=>y(p)),f=Array.from(u.layers),[w]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),b=f.indexOf(w),m=h?f.indexOf(h):-1,v=u.layersWithOutsidePointerEventsDisabled.size>0,_=m>=b,O=so(p=>{const S=p.target,N=[...u.branches].some(D=>D.contains(S));!_||N||(s==null||s(p),i==null||i(p),p.defaultPrevented||c==null||c())},E),H=ao(p=>{const S=p.target;[...u.branches].some(D=>D.contains(S))||(d==null||d(p),i==null||i(p),p.defaultPrevented||c==null||c())},E);return Rt(p=>{m===u.layers.size-1&&(a==null||a(p),!p.defaultPrevented&&c&&(p.preventDefault(),c()))},E),o.useEffect(()=>{if(h)return e&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(Ae=E.body.style.pointerEvents,E.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(h)),u.layers.add(h),Le(),()=>{e&&u.layersWithOutsidePointerEventsDisabled.size===1&&(E.body.style.pointerEvents=Ae)}},[h,E,e,u]),o.useEffect(()=>()=>{h&&(u.layers.delete(h),u.layersWithOutsidePointerEventsDisabled.delete(h),Le())},[h,u]),o.useEffect(()=>{const p=()=>x({});return document.addEventListener(ye,p),()=>document.removeEventListener(ye,p)},[]),t.jsx(F.div,{...l,ref:C,style:{pointerEvents:v?_?"auto":"none":void 0,...n.style},onFocusCapture:j(n.onFocusCapture,H.onFocusCapture),onBlurCapture:j(n.onBlurCapture,H.onBlurCapture),onPointerDownCapture:j(n.onPointerDownCapture,O.onPointerDownCapture)})});He.displayName=eo;var no="DismissableLayerBranch",ro=o.forwardRef((n,r)=>{const e=o.useContext(Ve),a=o.useRef(null),s=W(r,a);return o.useEffect(()=>{const d=a.current;if(d)return e.branches.add(d),()=>{e.branches.delete(d)}},[e.branches]),t.jsx(F.div,{...n,ref:s})});ro.displayName=no;function so(n,r=globalThis==null?void 0:globalThis.document){const e=Pe(n),a=o.useRef(!1),s=o.useRef(()=>{});return o.useEffect(()=>{const d=c=>{if(c.target&&!a.current){let l=function(){We(to,e,u,{discrete:!0})};const u={originalEvent:c};c.pointerType==="touch"?(r.removeEventListener("click",s.current),s.current=l,r.addEventListener("click",s.current,{once:!0})):l()}else r.removeEventListener("click",s.current);a.current=!1},i=window.setTimeout(()=>{r.addEventListener("pointerdown",d)},0);return()=>{window.clearTimeout(i),r.removeEventListener("pointerdown",d),r.removeEventListener("click",s.current)}},[r,e]),{onPointerDownCapture:()=>a.current=!0}}function ao(n,r=globalThis==null?void 0:globalThis.document){const e=Pe(n),a=o.useRef(!1);return o.useEffect(()=>{const s=d=>{d.target&&!a.current&&We(oo,e,{originalEvent:d},{discrete:!1})};return r.addEventListener("focusin",s),()=>r.removeEventListener("focusin",s)},[r,e]),{onFocusCapture:()=>a.current=!0,onBlurCapture:()=>a.current=!1}}function Le(){const n=new CustomEvent(ye);document.dispatchEvent(n)}function We(n,r,e,{discrete:a}){const s=e.originalEvent.target,d=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:e});r&&s.addEventListener(n,r,{once:!0}),a?jt(s,d):s.dispatchEvent(d)}var io=[" ","Enter","ArrowUp","ArrowDown"],co=[" ","Enter"],ae="Select",[ue,pe,lo]=_t(ae),[ne,Jo]=Dt(ae,[lo,Me]),fe=Me(),[uo,X]=ne(ae),[po,fo]=ne(ae),Ue=n=>{const{__scopeSelect:r,children:e,open:a,defaultOpen:s,onOpenChange:d,value:i,defaultValue:c,onValueChange:l,dir:u,name:h,autoComplete:y,disabled:E,required:x,form:C}=n,f=fe(r),[w,b]=o.useState(null),[m,v]=o.useState(null),[_,O]=o.useState(!1),H=Ut(u),[p=!1,S]=je({prop:a,defaultProp:s,onChange:d}),[N,D]=je({prop:i,defaultProp:c,onChange:l}),M=o.useRef(null),A=w?C||!!w.closest("form"):!0,[k,L]=o.useState(new Set),K=Array.from(k).map(B=>B.props.value).join(";");return t.jsx(zt,{...f,children:t.jsxs(uo,{required:x,scope:r,trigger:w,onTriggerChange:b,valueNode:m,onValueNodeChange:v,valueNodeHasChildren:_,onValueNodeHasChildrenChange:O,contentId:Ie(),value:N,onValueChange:D,open:p,onOpenChange:S,dir:H,triggerPointerDownPosRef:M,disabled:E,children:[t.jsx(ue.Provider,{scope:r,children:t.jsx(po,{scope:n.__scopeSelect,onNativeOptionAdd:o.useCallback(B=>{L(z=>new Set(z).add(B))},[]),onNativeOptionRemove:o.useCallback(B=>{L(z=>{const $=new Set(z);return $.delete(B),$})},[]),children:e})}),A?t.jsxs(mt,{"aria-hidden":!0,required:x,tabIndex:-1,name:h,autoComplete:y,value:N,onChange:B=>D(B.target.value),disabled:E,form:C,children:[N===void 0?t.jsx("option",{value:""}):null,Array.from(k)]},K):null]})})};Ue.displayName=ae;var ze="SelectTrigger",Ke=o.forwardRef((n,r)=>{const{__scopeSelect:e,disabled:a=!1,...s}=n,d=fe(e),i=X(ze,e),c=i.disabled||a,l=W(r,i.onTriggerChange),u=pe(e),h=o.useRef("touch"),[y,E,x]=ht(f=>{const w=u().filter(v=>!v.disabled),b=w.find(v=>v.value===i.value),m=vt(w,f,b);m!==void 0&&i.onValueChange(m.value)}),C=f=>{c||(i.onOpenChange(!0),x()),f&&(i.triggerPointerDownPosRef.current={x:Math.round(f.pageX),y:Math.round(f.pageY)})};return t.jsx(Ot,{asChild:!0,...d,children:t.jsx(F.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:c,"data-disabled":c?"":void 0,"data-placeholder":ft(i.value)?"":void 0,...s,ref:l,onClick:j(s.onClick,f=>{f.currentTarget.focus(),h.current!=="mouse"&&C(f)}),onPointerDown:j(s.onPointerDown,f=>{h.current=f.pointerType;const w=f.target;w.hasPointerCapture(f.pointerId)&&w.releasePointerCapture(f.pointerId),f.button===0&&f.ctrlKey===!1&&f.pointerType==="mouse"&&(C(f),f.preventDefault())}),onKeyDown:j(s.onKeyDown,f=>{const w=y.current!=="";!(f.ctrlKey||f.altKey||f.metaKey)&&f.key.length===1&&E(f.key),!(w&&f.key===" ")&&io.includes(f.key)&&(C(),f.preventDefault())})})})});Ke.displayName=ze;var $e="SelectValue",qe=o.forwardRef((n,r)=>{const{__scopeSelect:e,className:a,style:s,children:d,placeholder:i="",...c}=n,l=X($e,e),{onValueNodeHasChildrenChange:u}=l,h=d!==void 0,y=W(r,l.onValueNodeChange);return Y(()=>{u(h)},[u,h]),t.jsx(F.span,{...c,ref:y,style:{pointerEvents:"none"},children:ft(l.value)?t.jsx(t.Fragment,{children:i}):d})});qe.displayName=$e;var mo="SelectIcon",Ge=o.forwardRef((n,r)=>{const{__scopeSelect:e,children:a,...s}=n;return t.jsx(F.span,{"aria-hidden":!0,...s,ref:r,children:a||"▼"})});Ge.displayName=mo;var ho="SelectPortal",Ye=n=>t.jsx(Wt,{asChild:!0,...n});Ye.displayName=ho;var ee="SelectContent",Xe=o.forwardRef((n,r)=>{const e=X(ee,n.__scopeSelect),[a,s]=o.useState();if(Y(()=>{s(new DocumentFragment)},[]),!e.open){const d=a;return d?ke.createPortal(t.jsx(Ze,{scope:n.__scopeSelect,children:t.jsx(ue.Slot,{scope:n.__scopeSelect,children:t.jsx("div",{children:n.children})})}),d):null}return t.jsx(Je,{...n,ref:r})});Xe.displayName=ee;var U=10,[Ze,Z]=ne(ee),vo="SelectContentImpl",Je=o.forwardRef((n,r)=>{const{__scopeSelect:e,position:a="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:d,onPointerDownOutside:i,side:c,sideOffset:l,align:u,alignOffset:h,arrowPadding:y,collisionBoundary:E,collisionPadding:x,sticky:C,hideWhenDetached:f,avoidCollisions:w,...b}=n,m=X(ee,e),[v,_]=o.useState(null),[O,H]=o.useState(null),p=W(r,g=>_(g)),[S,N]=o.useState(null),[D,M]=o.useState(null),A=pe(e),[k,L]=o.useState(!1),K=o.useRef(!1);o.useEffect(()=>{if(v)return At(v)},[v]),Lt();const B=o.useCallback(g=>{const[R,...V]=A().map(P=>P.ref.current),[I]=V.slice(-1),T=document.activeElement;for(const P of g)if(P===T||(P==null||P.scrollIntoView({block:"nearest"}),P===R&&O&&(O.scrollTop=0),P===I&&O&&(O.scrollTop=O.scrollHeight),P==null||P.focus(),document.activeElement!==T))return},[A,O]),z=o.useCallback(()=>B([S,v]),[B,S,v]);o.useEffect(()=>{k&&z()},[k,z]);const{onOpenChange:$,triggerPointerDownPosRef:G}=m;o.useEffect(()=>{if(v){let g={x:0,y:0};const R=I=>{var T,P;g={x:Math.abs(Math.round(I.pageX)-(((T=G.current)==null?void 0:T.x)??0)),y:Math.abs(Math.round(I.pageY)-(((P=G.current)==null?void 0:P.y)??0))}},V=I=>{g.x<=10&&g.y<=10?I.preventDefault():v.contains(I.target)||$(!1),document.removeEventListener("pointermove",R),G.current=null};return G.current!==null&&(document.addEventListener("pointermove",R),document.addEventListener("pointerup",V,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",R),document.removeEventListener("pointerup",V,{capture:!0})}}},[v,$,G]),o.useEffect(()=>{const g=()=>$(!1);return window.addEventListener("blur",g),window.addEventListener("resize",g),()=>{window.removeEventListener("blur",g),window.removeEventListener("resize",g)}},[$]);const[me,ie]=ht(g=>{const R=A().filter(T=>!T.disabled),V=R.find(T=>T.ref.current===document.activeElement),I=vt(R,g,V);I&&setTimeout(()=>I.ref.current.focus())}),he=o.useCallback((g,R,V)=>{const I=!K.current&&!V;(m.value!==void 0&&m.value===R||I)&&(N(g),I&&(K.current=!0))},[m.value]),ve=o.useCallback(()=>v==null?void 0:v.focus(),[v]),te=o.useCallback((g,R,V)=>{const I=!K.current&&!V;(m.value!==void 0&&m.value===R||I)&&M(g)},[m.value]),ce=a==="popper"?Ce:Qe,re=ce===Ce?{side:c,sideOffset:l,align:u,alignOffset:h,arrowPadding:y,collisionBoundary:E,collisionPadding:x,sticky:C,hideWhenDetached:f,avoidCollisions:w}:{};return t.jsx(Ze,{scope:e,content:v,viewport:O,onViewportChange:H,itemRefCallback:he,selectedItem:S,onItemLeave:ve,itemTextRefCallback:te,focusSelectedItem:z,selectedItemText:D,position:a,isPositioned:k,searchRef:me,children:t.jsx(Mt,{as:kt,allowPinchZoom:!0,children:t.jsx(Bt,{asChild:!0,trapped:m.open,onMountAutoFocus:g=>{g.preventDefault()},onUnmountAutoFocus:j(s,g=>{var R;(R=m.trigger)==null||R.focus({preventScroll:!0}),g.preventDefault()}),children:t.jsx(He,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:d,onPointerDownOutside:i,onFocusOutside:g=>g.preventDefault(),onDismiss:()=>m.onOpenChange(!1),children:t.jsx(ce,{role:"listbox",id:m.contentId,"data-state":m.open?"open":"closed",dir:m.dir,onContextMenu:g=>g.preventDefault(),...b,...re,onPlaced:()=>L(!0),ref:p,style:{display:"flex",flexDirection:"column",outline:"none",...b.style},onKeyDown:j(b.onKeyDown,g=>{const R=g.ctrlKey||g.altKey||g.metaKey;if(g.key==="Tab"&&g.preventDefault(),!R&&g.key.length===1&&ie(g.key),["ArrowUp","ArrowDown","Home","End"].includes(g.key)){let I=A().filter(T=>!T.disabled).map(T=>T.ref.current);if(["ArrowUp","End"].includes(g.key)&&(I=I.slice().reverse()),["ArrowUp","ArrowDown"].includes(g.key)){const T=g.target,P=I.indexOf(T);I=I.slice(P+1)}setTimeout(()=>B(I)),g.preventDefault()}})})})})})})});Je.displayName=vo;var go="SelectItemAlignedPosition",Qe=o.forwardRef((n,r)=>{const{__scopeSelect:e,onPlaced:a,...s}=n,d=X(ee,e),i=Z(ee,e),[c,l]=o.useState(null),[u,h]=o.useState(null),y=W(r,p=>h(p)),E=pe(e),x=o.useRef(!1),C=o.useRef(!0),{viewport:f,selectedItem:w,selectedItemText:b,focusSelectedItem:m}=i,v=o.useCallback(()=>{if(d.trigger&&d.valueNode&&c&&u&&f&&w&&b){const p=d.trigger.getBoundingClientRect(),S=u.getBoundingClientRect(),N=d.valueNode.getBoundingClientRect(),D=b.getBoundingClientRect();if(d.dir!=="rtl"){const T=D.left-S.left,P=N.left-T,J=p.left-P,Q=p.width+J,ge=Math.max(Q,S.width),xe=window.innerWidth-U,we=De(P,[U,Math.max(U,xe-ge)]);c.style.minWidth=Q+"px",c.style.left=we+"px"}else{const T=S.right-D.right,P=window.innerWidth-N.right-T,J=window.innerWidth-p.right-P,Q=p.width+J,ge=Math.max(Q,S.width),xe=window.innerWidth-U,we=De(P,[U,Math.max(U,xe-ge)]);c.style.minWidth=Q+"px",c.style.right=we+"px"}const M=E(),A=window.innerHeight-U*2,k=f.scrollHeight,L=window.getComputedStyle(u),K=parseInt(L.borderTopWidth,10),B=parseInt(L.paddingTop,10),z=parseInt(L.borderBottomWidth,10),$=parseInt(L.paddingBottom,10),G=K+B+k+$+z,me=Math.min(w.offsetHeight*5,G),ie=window.getComputedStyle(f),he=parseInt(ie.paddingTop,10),ve=parseInt(ie.paddingBottom,10),te=p.top+p.height/2-U,ce=A-te,re=w.offsetHeight/2,g=w.offsetTop+re,R=K+B+g,V=G-R;if(R<=te){const T=M.length>0&&w===M[M.length-1].ref.current;c.style.bottom="0px";const P=u.clientHeight-f.offsetTop-f.offsetHeight,J=Math.max(ce,re+(T?ve:0)+P+z),Q=R+J;c.style.height=Q+"px"}else{const T=M.length>0&&w===M[0].ref.current;c.style.top="0px";const J=Math.max(te,K+f.offsetTop+(T?he:0)+re)+V;c.style.height=J+"px",f.scrollTop=R-te+f.offsetTop}c.style.margin=`${U}px 0`,c.style.minHeight=me+"px",c.style.maxHeight=A+"px",a==null||a(),requestAnimationFrame(()=>x.current=!0)}},[E,d.trigger,d.valueNode,c,u,f,w,b,d.dir,a]);Y(()=>v(),[v]);const[_,O]=o.useState();Y(()=>{u&&O(window.getComputedStyle(u).zIndex)},[u]);const H=o.useCallback(p=>{p&&C.current===!0&&(v(),m==null||m(),C.current=!1)},[v,m]);return t.jsx(wo,{scope:e,contentWrapper:c,shouldExpandOnScrollRef:x,onScrollButtonChange:H,children:t.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:_},children:t.jsx(F.div,{...s,ref:y,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});Qe.displayName=go;var xo="SelectPopperPosition",Ce=o.forwardRef((n,r)=>{const{__scopeSelect:e,align:a="start",collisionPadding:s=U,...d}=n,i=fe(e);return t.jsx(Ft,{...i,...d,ref:r,align:a,collisionPadding:s,style:{boxSizing:"border-box",...d.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Ce.displayName=xo;var[wo,Re]=ne(ee,{}),Ee="SelectViewport",et=o.forwardRef((n,r)=>{const{__scopeSelect:e,nonce:a,...s}=n,d=Z(Ee,e),i=Re(Ee,e),c=W(r,d.onViewportChange),l=o.useRef(0);return t.jsxs(t.Fragment,{children:[t.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),t.jsx(ue.Slot,{scope:e,children:t.jsx(F.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:c,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:j(s.onScroll,u=>{const h=u.currentTarget,{contentWrapper:y,shouldExpandOnScrollRef:E}=i;if(E!=null&&E.current&&y){const x=Math.abs(l.current-h.scrollTop);if(x>0){const C=window.innerHeight-U*2,f=parseFloat(y.style.minHeight),w=parseFloat(y.style.height),b=Math.max(f,w);if(b<C){const m=b+x,v=Math.min(C,m),_=m-v;y.style.height=v+"px",y.style.bottom==="0px"&&(h.scrollTop=_>0?_:0,y.style.justifyContent="flex-end")}}}l.current=h.scrollTop})})})]})});et.displayName=Ee;var tt="SelectGroup",[So,yo]=ne(tt),Co=o.forwardRef((n,r)=>{const{__scopeSelect:e,...a}=n,s=Ie();return t.jsx(So,{scope:e,id:s,children:t.jsx(F.div,{role:"group","aria-labelledby":s,...a,ref:r})})});Co.displayName=tt;var ot="SelectLabel",nt=o.forwardRef((n,r)=>{const{__scopeSelect:e,...a}=n,s=yo(ot,e);return t.jsx(F.div,{id:s.id,...a,ref:r})});nt.displayName=ot;var le="SelectItem",[Eo,rt]=ne(le),st=o.forwardRef((n,r)=>{const{__scopeSelect:e,value:a,disabled:s=!1,textValue:d,...i}=n,c=X(le,e),l=Z(le,e),u=c.value===a,[h,y]=o.useState(d??""),[E,x]=o.useState(!1),C=W(r,m=>{var v;return(v=l.itemRefCallback)==null?void 0:v.call(l,m,a,s)}),f=Ie(),w=o.useRef("touch"),b=()=>{s||(c.onValueChange(a),c.onOpenChange(!1))};if(a==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return t.jsx(Eo,{scope:e,value:a,disabled:s,textId:f,isSelected:u,onItemTextChange:o.useCallback(m=>{y(v=>v||((m==null?void 0:m.textContent)??"").trim())},[]),children:t.jsx(ue.ItemSlot,{scope:e,value:a,disabled:s,textValue:h,children:t.jsx(F.div,{role:"option","aria-labelledby":f,"data-highlighted":E?"":void 0,"aria-selected":u&&E,"data-state":u?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...i,ref:C,onFocus:j(i.onFocus,()=>x(!0)),onBlur:j(i.onBlur,()=>x(!1)),onClick:j(i.onClick,()=>{w.current!=="mouse"&&b()}),onPointerUp:j(i.onPointerUp,()=>{w.current==="mouse"&&b()}),onPointerDown:j(i.onPointerDown,m=>{w.current=m.pointerType}),onPointerMove:j(i.onPointerMove,m=>{var v;w.current=m.pointerType,s?(v=l.onItemLeave)==null||v.call(l):w.current==="mouse"&&m.currentTarget.focus({preventScroll:!0})}),onPointerLeave:j(i.onPointerLeave,m=>{var v;m.currentTarget===document.activeElement&&((v=l.onItemLeave)==null||v.call(l))}),onKeyDown:j(i.onKeyDown,m=>{var _;((_=l.searchRef)==null?void 0:_.current)!==""&&m.key===" "||(co.includes(m.key)&&b(),m.key===" "&&m.preventDefault())})})})})});st.displayName=le;var se="SelectItemText",at=o.forwardRef((n,r)=>{const{__scopeSelect:e,className:a,style:s,...d}=n,i=X(se,e),c=Z(se,e),l=rt(se,e),u=fo(se,e),[h,y]=o.useState(null),E=W(r,b=>y(b),l.onItemTextChange,b=>{var m;return(m=c.itemTextRefCallback)==null?void 0:m.call(c,b,l.value,l.disabled)}),x=h==null?void 0:h.textContent,C=o.useMemo(()=>t.jsx("option",{value:l.value,disabled:l.disabled,children:x},l.value),[l.disabled,l.value,x]),{onNativeOptionAdd:f,onNativeOptionRemove:w}=u;return Y(()=>(f(C),()=>w(C)),[f,w,C]),t.jsxs(t.Fragment,{children:[t.jsx(F.span,{id:l.textId,...d,ref:E}),l.isSelected&&i.valueNode&&!i.valueNodeHasChildren?ke.createPortal(d.children,i.valueNode):null]})});at.displayName=se;var it="SelectItemIndicator",ct=o.forwardRef((n,r)=>{const{__scopeSelect:e,...a}=n;return rt(it,e).isSelected?t.jsx(F.span,{"aria-hidden":!0,...a,ref:r}):null});ct.displayName=it;var be="SelectScrollUpButton",lt=o.forwardRef((n,r)=>{const e=Z(be,n.__scopeSelect),a=Re(be,n.__scopeSelect),[s,d]=o.useState(!1),i=W(r,a.onScrollButtonChange);return Y(()=>{if(e.viewport&&e.isPositioned){let c=function(){const u=l.scrollTop>0;d(u)};const l=e.viewport;return c(),l.addEventListener("scroll",c),()=>l.removeEventListener("scroll",c)}},[e.viewport,e.isPositioned]),s?t.jsx(ut,{...n,ref:i,onAutoScroll:()=>{const{viewport:c,selectedItem:l}=e;c&&l&&(c.scrollTop=c.scrollTop-l.offsetHeight)}}):null});lt.displayName=be;var Ne="SelectScrollDownButton",dt=o.forwardRef((n,r)=>{const e=Z(Ne,n.__scopeSelect),a=Re(Ne,n.__scopeSelect),[s,d]=o.useState(!1),i=W(r,a.onScrollButtonChange);return Y(()=>{if(e.viewport&&e.isPositioned){let c=function(){const u=l.scrollHeight-l.clientHeight,h=Math.ceil(l.scrollTop)<u;d(h)};const l=e.viewport;return c(),l.addEventListener("scroll",c),()=>l.removeEventListener("scroll",c)}},[e.viewport,e.isPositioned]),s?t.jsx(ut,{...n,ref:i,onAutoScroll:()=>{const{viewport:c,selectedItem:l}=e;c&&l&&(c.scrollTop=c.scrollTop+l.offsetHeight)}}):null});dt.displayName=Ne;var ut=o.forwardRef((n,r)=>{const{__scopeSelect:e,onAutoScroll:a,...s}=n,d=Z("SelectScrollButton",e),i=o.useRef(null),c=pe(e),l=o.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return o.useEffect(()=>()=>l(),[l]),Y(()=>{var h;const u=c().find(y=>y.ref.current===document.activeElement);(h=u==null?void 0:u.ref.current)==null||h.scrollIntoView({block:"nearest"})},[c]),t.jsx(F.div,{"aria-hidden":!0,...s,ref:r,style:{flexShrink:0,...s.style},onPointerDown:j(s.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(a,50))}),onPointerMove:j(s.onPointerMove,()=>{var u;(u=d.onItemLeave)==null||u.call(d),i.current===null&&(i.current=window.setInterval(a,50))}),onPointerLeave:j(s.onPointerLeave,()=>{l()})})}),bo="SelectSeparator",pt=o.forwardRef((n,r)=>{const{__scopeSelect:e,...a}=n;return t.jsx(F.div,{"aria-hidden":!0,...a,ref:r})});pt.displayName=bo;var Te="SelectArrow",No=o.forwardRef((n,r)=>{const{__scopeSelect:e,...a}=n,s=fe(e),d=X(Te,e),i=Z(Te,e);return d.open&&i.position==="popper"?t.jsx(Vt,{...s,...a,ref:r}):null});No.displayName=Te;function ft(n){return n===""||n===void 0}var mt=o.forwardRef((n,r)=>{const{value:e,...a}=n,s=o.useRef(null),d=W(r,s),i=Xt(e);return o.useEffect(()=>{const c=s.current,l=window.HTMLSelectElement.prototype,h=Object.getOwnPropertyDescriptor(l,"value").set;if(i!==e&&h){const y=new Event("change",{bubbles:!0});h.call(c,e),c.dispatchEvent(y)}},[i,e]),t.jsx(Ht,{asChild:!0,children:t.jsx("select",{...a,ref:d,defaultValue:e})})});mt.displayName="BubbleSelect";function ht(n){const r=Pe(n),e=o.useRef(""),a=o.useRef(0),s=o.useCallback(i=>{const c=e.current+i;r(c),function l(u){e.current=u,window.clearTimeout(a.current),u!==""&&(a.current=window.setTimeout(()=>l(""),1e3))}(c)},[r]),d=o.useCallback(()=>{e.current="",window.clearTimeout(a.current)},[]);return o.useEffect(()=>()=>window.clearTimeout(a.current),[]),[e,s,d]}function vt(n,r,e){const s=r.length>1&&Array.from(r).every(u=>u===r[0])?r[0]:r,d=e?n.indexOf(e):-1;let i=To(n,Math.max(d,0));s.length===1&&(i=i.filter(u=>u!==e));const l=i.find(u=>u.textValue.toLowerCase().startsWith(s.toLowerCase()));return l!==e?l:void 0}function To(n,r){return n.map((e,a)=>n[(r+a)%n.length])}var Po=Ue,gt=Ke,Io=qe,Ro=Ge,jo=Ye,xt=Xe,_o=et,wt=nt,St=st,Do=at,Oo=ct,yt=lt,Ct=dt,Et=pt;const Ao=Po,Lo=Io,bt=o.forwardRef(({className:n,children:r,...e},a)=>t.jsxs(gt,{ref:a,className:q("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",n),...e,children:[r,t.jsx(Ro,{asChild:!0,children:t.jsx(Be,{className:"h-4 w-4 opacity-50"})})]}));bt.displayName=gt.displayName;const Nt=o.forwardRef(({className:n,...r},e)=>t.jsx(yt,{ref:e,className:q("flex cursor-default items-center justify-center py-1",n),...r,children:t.jsx(Jt,{className:"h-4 w-4"})}));Nt.displayName=yt.displayName;const Tt=o.forwardRef(({className:n,...r},e)=>t.jsx(Ct,{ref:e,className:q("flex cursor-default items-center justify-center py-1",n),...r,children:t.jsx(Be,{className:"h-4 w-4"})}));Tt.displayName=Ct.displayName;const Pt=o.forwardRef(({className:n,children:r,position:e="popper",...a},s)=>t.jsx(jo,{children:t.jsxs(xt,{ref:s,className:q("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",n),position:e,...a,children:[t.jsx(Nt,{}),t.jsx(_o,{className:q("p-1",e==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),t.jsx(Tt,{})]})}));Pt.displayName=xt.displayName;const Mo=o.forwardRef(({className:n,...r},e)=>t.jsx(wt,{ref:e,className:q("py-1.5 pl-8 pr-2 text-sm font-semibold",n),...r}));Mo.displayName=wt.displayName;const It=o.forwardRef(({className:n,children:r,...e},a)=>t.jsxs(St,{ref:a,className:q("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n),...e,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(Oo,{children:t.jsx(Kt,{className:"h-4 w-4"})})}),t.jsx(Do,{children:r})]}));It.displayName=St.displayName;const ko=o.forwardRef(({className:n,...r},e)=>t.jsx(Et,{ref:e,className:q("-mx-1 my-1 h-px bg-muted",n),...r}));ko.displayName=Et.displayName;const Bo=({closedSize:n,placeholder:r,children:e,onValueChange:a})=>{const[s,d]=o.useState(!1),i=()=>{switch(n){case"xs":return"";case"sm":return"w-56";case"md":return"w-72";case"lg":return"w-96";default:return""}};return t.jsxs(t.Fragment,{children:[s&&t.jsx(Gt,{onClose:()=>d(!1),open:s}),t.jsxs(Ao,{onOpenChange:d,open:s,onValueChange:c=>{a&&a(c)},children:[t.jsx(bt,{className:q(s?"z-[20] w-full sm:max-w-xs":i()),children:t.jsx(Lo,{placeholder:r})}),e]})]})},Fo=({networks:n,ssidCharacteristic:r,passwordCharacteristic:e,disconnect:a})=>{const[s,d]=o.useState(!1),i=o.useMemo(()=>n.filter(x=>x!=="").sort((x,C)=>x.localeCompare(C)),[n]),c=$t(),[l,u]=o.useState(null),[h,y]=o.useState(null),E=async()=>{if(!r||!e){oe.error("Dispositivo não encontrado."),console.error("No device selected");return}if(!l||!h){oe.error("Preencha todos os campos."),console.error("Fields not filled");return}console.log("Sending credentials: ",{selectedNetwork:l,password:h}),d(!0);try{if(!r||!e)throw new Error("Characteristic not found");const x=new TextEncoder;await r.writeValueWithResponse(x.encode(l)),await e.writeValueWithResponse(x.encode(h)),oe.success("Credenciais enviadas com sucesso."),a(),c("/totems")}catch(x){oe.error("Erro ao enviar credenciais."),console.error("Failed to send credentials: ",x)}d(!1)};return t.jsxs(t.Fragment,{children:[t.jsxs("h1",{className:"font-semibold text-2xl mx-auto",children:["Totem conectado ",t.jsx(Zt,{className:"inline-block text-positive"})]}),t.jsx("p",{className:"text-sm",children:"Preencha os campos abaixo para conectar o totem à sua rede."}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(_e,{title:t.jsxs("div",{className:"flex items-center gap-1",children:["Rede",t.jsx(Oe,{size:14,className:"mb-4"})]}),tooltip:"A senha da rede que deseja conectar.",children:t.jsx(Bo,{closedSize:"sm",placeholder:"Conectar a rede",onValueChange:x=>u(x),children:t.jsx(Pt,{children:i.map((x,C)=>t.jsx(It,{value:x,children:x},C))})})}),t.jsx(_e,{title:t.jsxs("div",{className:"flex items-center gap-1",children:["Senha",t.jsx(Oe,{size:14,className:"mb-4"})]}),tooltip:"A senha da rede que deseja conectar.",children:t.jsx(Yt,{type:"text",placeholder:"Senha da rede",name:"password",required:!0,closedSize:"sm",onChange:x=>y(x.target.value)})}),t.jsxs("div",{className:"flex justify-between gap-2 pt-2",children:[t.jsx(Se,{className:"w-full",variant:"ghost",onClick:a,disabled:s,children:"Cancelar"}),t.jsxs(Se,{className:"w-full bg-white text-primary",onClick:E,disabled:s,children:[s?t.jsx(Fe,{className:"mr-2 h-4 w-4 animate-spin"}):null,s?"Enviando...":"Enviar"]})]})]})]})},Vo=({isScanning:n,startScan:r})=>t.jsxs(t.Fragment,{children:[t.jsx("h1",{className:"font-semibold text-2xl mx-auto",children:"Parear totem"}),t.jsx("p",{className:"text-sm",children:"Mantenha o botão de pareamento do totem pressionado até a luz piscar e clique no botão abaixo para iniciar a busca."}),t.jsx("div",{className:"flex flex-col gap-4",children:t.jsxs(Se,{onClick:r,disabled:n,className:"w-full bg-white text-primary hover:bg-gray-100 transition-colors",children:[n?t.jsx(Fe,{className:"mr-2 h-4 w-4 animate-spin"}):t.jsx(Qt,{className:"mr-2"}),n?"Escaneando...":"Iniciar busca"]})})]}),Qo=()=>{const[n,r]=o.useState([]),[e,a]=o.useState(!1),[s,d]=o.useState(null),[i,c]=o.useState(null),[l,u]=o.useState(!1),[h,y]=o.useState({}),E="376ef6fe-e050-47f3-b68d-de711430d4cf",x={LIST:"6db902b8-3853-4eaf-a55e-a48559fac157",SSID:"14796829-59dc-4f1b-90d8-e1f3a02f1248",PASSWORD:"839c314c-7b1d-40aa-8782-525e7bac8477"},C=o.useCallback(()=>{console.log("Disconnection event triggered"),u(!1),y({}),r([])},[]);o.useEffect(()=>()=>{i&&i.removeEventListener("gattserverdisconnected",C)},[i,C]);const f=async()=>{var p;try{(p=i==null?void 0:i.gatt)!=null&&p.connected&&(i.removeEventListener("gattserverdisconnected",C),await i.gatt.disconnect()),c(null)}catch(S){H(S)}finally{u(!1),y({}),r([])}},w=async p=>{if(!p.gatt)throw new Error("Bluetooth GATT not available");try{return await p.gatt.connect()}catch(S){console.error("Connection error:",S),await new Promise(N=>setTimeout(N,500));try{return await p.gatt.connect()}catch(N){throw new Error(`Failed to connect to device: ${N}`)}}},b=async(p,S,N=3)=>{var M;let D;for(let A=0;A<N;A++)try{return await p()}catch(k){if(D=k,console.warn(`GATT operation failed (attempt ${A+1}/${N}):`,k),(M=S.gatt)!=null&&M.connected)await new Promise(L=>setTimeout(L,300));else try{await w(S),await new Promise(L=>setTimeout(L,300))}catch(L){console.error("Reconnection failed:",L)}}throw new Error(`Operation failed after ${N} retries: ${D||"Unknown error"}`)},m=async p=>{const S=await p.readValue();return new TextDecoder("utf-8").decode(S).split(`
`).filter(Boolean)},v=async p=>{try{p.addEventListener("gattserverdisconnected",C);const S=await w(p),N=await b(()=>S.getPrimaryService(E),p),[D,M,A]=await Promise.all([b(()=>N.getCharacteristic(x.LIST),p),b(()=>N.getCharacteristic(x.SSID),p),b(()=>N.getCharacteristic(x.PASSWORD),p)]);y({ssid:M,password:A}),console.log("Reading network list...");const k=await m(D);console.log("Networks found:",k),r(k),u(!0)}catch(S){p.removeEventListener("gattserverdisconnected",C),H(S)}},_=async()=>{if(a(!0),d(null),r([]),i)try{console.log("Disconnecting existing device"),await f(),console.log("Device disconnected"),await new Promise(p=>setTimeout(p,500))}catch(p){console.error("Failed to disconnect device",p),oe.error("Error disconnecting device")}console.log("Requesting Bluetooth device...");try{const p=await navigator.bluetooth.requestDevice({optionalServices:[E],filters:[{manufacturerData:[{companyIdentifier:42678}]}]});console.log("Device found:",p),c(p),await v(p)}catch(p){H(p)}finally{a(!1)}},O=()=>{a(!1),f()},H=p=>{const S=p instanceof Error?p.message:"Unknown error occurred";let N=S;S.includes("GATT operation failed")?N="Erro de conexão. Por favor tente novamente. (Tente reiniciar o totem)":S.startsWith("User cancelled")&&(N="Operação cancelada pelo usuário"),d(N),console.error("Error details:",p),S.startsWith("User cancelled")||oe.error(N),O()};return t.jsxs("div",{className:"w-full flex flex-col items-center justify-center gap-3",children:[t.jsx(qt,{border:!0,className:"flex-col flex gap-5 p-4 shadow-lg w-full max-w-md text-white",children:l?n.length>0?t.jsx(Fo,{networks:n,ssidCharacteristic:h.ssid,passwordCharacteristic:h.password,disconnect:f}):t.jsx("div",{children:"Algo deu errado"}):t.jsx(Vo,{startScan:_,isScanning:e})}),s&&t.jsx("div",{className:"p-3 bg-white rounded-md animate-pulse",children:t.jsx("p",{className:"text-destructive font-medium",children:s})})]})};export{Qo as default};
